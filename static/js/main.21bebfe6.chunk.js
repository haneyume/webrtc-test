(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t){},128:function(e,t,n){"use strict";n.r(t);var a=n(133),c=n(1),r=n.n(c),i=n(8),o=n.n(i),s=n(20),u=n(62),p=n(63),l=n(81),d=n(64),f=n(82),m=n(18),h=n(132),v=n(65),w=n.n(v)()("https://vvk954yznl.sse.codesandbox.io/"),b=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).initialize=Object(s.a)(o.a.mark(function e(){var t,a,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={audio:!0,video:!0},a={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},e.next=4,navigator.mediaDevices.getUserMedia(t);case 4:c=e.sent,n.localVideo.current.srcObject=c,n.pc=new RTCPeerConnection(a),n.pc.addStream(c),n.pc.onicecandidate=function(e){e.candidate&&n.sendData(e.candidate)},n.pc.onaddstream=function(e){n.remoteVideo.current.srcObject=e.stream},n.pc.oniceconnectionstatechange=function(e){console.log(n.pc?n.pc.iceConnectionState:"...")};case 11:case"end":return e.stop()}},e,this)})),n.call=Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.pc.createOffer();case 2:return t=e.sent,e.next=5,n.pc.setLocalDescription(t);case 5:n.sendData(t);case 6:case"end":return e.stop()}},e,this)})),n.hangup=Object(s.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.pc.close(),n.pc=null,n.initialize();case 3:case"end":return e.stop()}},e,this)})),n.sendData=function(){var e=Object(s.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:w.emit("webrtc",JSON.stringify(t));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=Object(s.a)(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),void 0!==t.type){e.next=5;break}n.pc.addIceCandidate(t),e.next=16;break;case 5:if("offer"!==t.type){e.next=15;break}return n.pc.setRemoteDescription(t),e.next=9,n.pc.createAnswer();case 9:return a=e.sent,e.next=12,n.pc.setLocalDescription(a);case 12:n.sendData(a),e.next=16;break;case 15:"answer"===t.type&&n.pc.setRemoteDescription(t);case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.localVideo=r.a.createRef(),n.remoteVideo=r.a.createRef(),n.pc=null,n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;w.on("webrtc",function(t){return e.receiveData(JSON.parse(t))}),this.initialize()}},{key:"componentWillUnmount",value:function(){w.off("x")}},{key:"render",value:function(){return r.a.createElement(c.Fragment,null,r.a.createElement(m.a,{style:{flexDirection:"row"}},r.a.createElement(h.a,{title:"Call",onPress:this.call}),r.a.createElement(m.a,{style:{width:10}}),r.a.createElement(h.a,{title:"Hangup",onPress:this.hangup})),r.a.createElement(m.a,null,r.a.createElement("video",{ref:this.localVideo,width:"300",autoPlay:!0,muted:!0}),r.a.createElement("video",{ref:this.remoteVideo,width:"300",autoPlay:!0})))}}]),t}(c.Component),x=function(){return r.a.createElement(b,null)};a.a.registerComponent("app",function(){return x}),a.a.runApplication("app",{rootTag:document.getElementById("root")})},84:function(e,t,n){e.exports=n(128)}},[[84,1,2]]]);
//# sourceMappingURL=main.21bebfe6.chunk.js.map