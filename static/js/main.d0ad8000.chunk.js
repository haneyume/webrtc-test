(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{54:function(e,t,n){e.exports=n(97)},83:function(e,t){},97:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(47),i=n.n(c),o=n(50),s=n(10),u=function(){return r.a.createElement("p",null,"WebRTC")},p=n(2),l=n.n(p),d=n(4),f=n(13),m=n(14),h=n(17),v=n(15),w=n(18),b=n(48),x=n.n(b)()("https://vvk954yznl.sse.codesandbox.io/"),k=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(h.a)(this,Object(v.a)(t).call(this,e))).initialize=Object(d.a)(l.a.mark(function e(){var t,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return x.on("webrtc",function(e){return n.receiveData(JSON.parse(e))}),t={audio:!1,video:{width:640,height:480}},a={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},e.next=5,navigator.mediaDevices.getUserMedia(t);case 5:r=e.sent,n.localVideo.current.srcObject=r,n.pc=new RTCPeerConnection(a),n.pc.addStream(r),n.pc.onicecandidate=function(e){e.candidate&&n.sendData(e.candidate)},n.pc.onaddstream=function(e){console.log(e.stream)},n.pc.oniceconnectionstatechange=function(){console.log(n.pc?n.pc.iceConnectionState:"...")};case 12:case"end":return e.stop()}},e)})),n.uninitialize=Object(d.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x.off("webrtc");case 1:case"end":return e.stop()}},e)})),n.sendData=function(){var e=Object(d.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x.emit("webrtc",JSON.stringify(t));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=Object(d.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.type){e.next=5;break}return e.next=3,n.pc.addIceCandidate(t);case 3:e.next=19;break;case 5:if("offer"!==t.type){e.next=16;break}return e.next=8,n.pc.setRemoteDescription(t);case 8:return e.next=10,n.pc.createAnswer();case 10:return a=e.sent,e.next=13,n.pc.setLocalDescription(a);case 13:n.sendData(a),e.next=19;break;case 16:if("answer"!==t.type){e.next=19;break}return e.next=19,n.pc.setRemoteDescription(t);case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.localVideo=r.a.createRef(),n.pc=null,n}return Object(w.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.initialize()}},{key:"componentWillUnmount",value:function(){this.uninitialize()}},{key:"render",value:function(){return r.a.createElement("video",{ref:this.localVideo,width:"320",height:"240",autoPlay:!0,muted:!0})}}]),t}(r.a.Component),O=n(98),y=n(99),g=n(100),j=window.faceapi,D=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(h.a)(this,Object(v.a)(t).call(this,e))).initialize=Object(d.a)(l.a.mark(function e(){var t,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return x.on("webrtc",function(e){return n.receiveData(JSON.parse(e))}),t={audio:!1,video:{width:640,height:480}},a={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},e.next=5,navigator.mediaDevices.getUserMedia(t);case 5:r=e.sent,n.pc=new RTCPeerConnection(a),n.localVideo.current.srcObject=r,n.pc.addStream(r),n.pc.onicecandidate=function(e){e.candidate&&n.sendData(e.candidate)},n.pc.onaddstream=function(e){n.remoteVideo.current.srcObject=e.stream,n.remoteVideo.current.addEventListener("play",n.detectFace())},n.pc.oniceconnectionstatechange=function(){console.log(n.pc?n.pc.iceConnectionState:"...")};case 12:case"end":return e.stop()}},e)})),n.uninitialize=Object(d.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x.off("webrtc");case 1:case"end":return e.stop()}},e)})),n.call=Object(d.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.pc.createOffer();case 2:return t=e.sent,e.next=5,n.pc.setLocalDescription(t);case 5:n.sendData(t);case 6:case"end":return e.stop()}},e)})),n.sendData=function(){var e=Object(d.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x.emit("webrtc",JSON.stringify(t));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=Object(d.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.type){e.next=4;break}n.pc.addIceCandidate(t),e.next=18;break;case 4:if("offer"!==t.type){e.next=15;break}return e.next=7,n.pc.setRemoteDescription(t);case 7:return e.next=9,n.pc.createAnswer();case 9:return a=e.sent,e.next=12,n.pc.setLocalDescription(a);case 12:n.sendData(a),e.next=18;break;case 15:if("answer"!==t.type){e.next=18;break}return e.next=18,n.pc.setRemoteDescription(t);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.detectFace=Object(d.a)(l.a.mark(function e(){var t,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.canvas.current,a=n.remoteVideo.current,r=t.getContext("2d"),setInterval(function(){var e=Object(d.a)(l.a.mark(function e(){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.detectAllFaces(a,new j.TinyFaceDetectorOptions).withFaceLandmarks().withFaceExpressions();case 2:n=e.sent,r.clearRect(0,0,t.width,t.height),r.drawImage(a,0,0,t.width,t.height),j.draw.drawDetections(t,n),j.draw.drawFaceLandmarks(t,n),j.draw.drawFaceExpressions(t,n);case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),100);case 5:case"end":return e.stop()}},e)})),n.localVideo=r.a.createRef(),n.remoteVideo=r.a.createRef(),n.pc=null,n.canvas=r.a.createRef(),n}return Object(w.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([j.nets.tinyFaceDetector.loadFromUri("/models"),j.nets.faceLandmark68Net.loadFromUri("/models"),j.nets.faceRecognitionNet.loadFromUri("/models"),j.nets.faceExpressionNet.loadFromUri("/models")]);case 2:return e.next=4,this.initialize();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.uninitialize()}},{key:"render",value:function(){return r.a.createElement(O.a,null,r.a.createElement(y.a,null,r.a.createElement(g.a,{color:"success",onClick:this.call},"Start")),r.a.createElement(y.a,null,r.a.createElement("canvas",{ref:this.canvas,width:"640",height:"480"})),r.a.createElement("video",{ref:this.localVideo,width:"0",height:"0",autoPlay:!0,muted:!0}),r.a.createElement("video",{ref:this.remoteVideo,width:"0",height:"0",autoPlay:!0}))}}]),t}(r.a.Component),E=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(h.a)(this,Object(v.a)(t).call(this,e))).initialize=Object(d.a)(l.a.mark(function e(){var t,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return x.on("webrtc",function(e){return n.receiveData(JSON.parse(e))}),t={audio:!0,video:!0},a={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},e.next=5,navigator.mediaDevices.getUserMedia(t);case 5:r=e.sent,n.localVideo.current.srcObject=r,n.pc=new RTCPeerConnection(a),n.pc.addStream(r),n.pc.onicecandidate=function(e){e.candidate&&n.sendData(e.candidate)},n.pc.onaddstream=function(e){n.remoteVideo.current.srcObject=e.stream},n.pc.oniceconnectionstatechange=function(){console.log(n.pc?n.pc.iceConnectionState:"...")};case 12:case"end":return e.stop()}},e)})),n.uninitialize=Object(d.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x.off("webrtc");case 1:case"end":return e.stop()}},e)})),n.call=Object(d.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.pc.createOffer();case 2:return t=e.sent,e.next=5,n.pc.setLocalDescription(t);case 5:n.sendData(t);case 6:case"end":return e.stop()}},e)})),n.hangup=Object(d.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.pc.close(),n.pc=null,n.initialize();case 3:case"end":return e.stop()}},e)})),n.sendData=function(){var e=Object(d.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x.emit("webrtc",JSON.stringify(t));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=Object(d.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.type){e.next=5;break}return e.next=3,n.pc.addIceCandidate(t);case 3:e.next=19;break;case 5:if("offer"!==t.type){e.next=16;break}return e.next=8,n.pc.setRemoteDescription(t);case 8:return e.next=10,n.pc.createAnswer();case 10:return a=e.sent,e.next=13,n.pc.setLocalDescription(a);case 13:n.sendData(a),e.next=19;break;case 16:if("answer"!==t.type){e.next=19;break}return e.next=19,n.pc.setRemoteDescription(t);case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.localVideo=r.a.createRef(),n.remoteVideo=r.a.createRef(),n.pc=null,n}return Object(w.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.initialize()}},{key:"componentWillUnmount",value:function(){this.uninitialize()}},{key:"render",value:function(){return r.a.createElement(O.a,null,r.a.createElement(y.a,null,r.a.createElement(g.a,{color:"success",onPress:this.call},"Call"),r.a.createElement(g.a,{color:"danger",onPress:this.hangup},"Hangup")),r.a.createElement(y.a,null,r.a.createElement("video",{ref:this.localVideo,width:"300",autoPlay:!0,muted:!0}),r.a.createElement("video",{ref:this.remoteVideo,width:"300",autoPlay:!0})))}}]),t}(r.a.Component);n(88);i.a.render(r.a.createElement(function(){return r.a.createElement(o.a,null,r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/",exact:!0,component:u}),r.a.createElement(s.a,{path:"/p1",component:k}),r.a.createElement(s.a,{path:"/p2",component:D}),r.a.createElement(s.a,{path:"/webrtc",component:E})))},null),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.d0ad8000.chunk.js.map