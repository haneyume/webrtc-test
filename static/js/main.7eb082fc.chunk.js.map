{"version":3,"sources":["WebRTCView.js","App.js","index.js"],"names":["socket","io","_default","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","start","pc","RTCPeerConnection","iceServers","urls","onicecandidate","event","candidate","sendData","onaddstream","remoteVideo","current","srcObject","stream","navigator","mediaDevices","getUserMedia","audio","video","then","localVideo","addStream","asyncToGenerator","regenerator_default","a","mark","_callee","offer","wrap","_context","prev","next","createOffer","sent","setLocalDescription","sdp","localDescription","stop","hangup","_callee2","_context2","close","_ref3","_callee3","data","_context3","emit","JSON","stringify","_x","apply","arguments","receiveData","_ref4","_callee4","answer","_context4","undefined","addIceCandidate","RTCIceCandidate","type","setRemoteDescription","RTCSessionDescription","createAnswer","_x2","React","createRef","_this2","on","parse","off","react_default","createElement","react","View","style","flexDirection","justifyContent","alignItems","margin","Button","title","onPress","width","ref","autoPlay","muted","Component","App","WebRTCView_default","AppRegistry","registerComponent","runApplication","rootTag","document","getElementById"],"mappings":"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","file":"static/js/main.7eb082fc.chunk.js","sourcesContent":["import React, { Component, Fragment } from 'react';\r\nimport { View, Button } from 'react-native';\r\n\r\nimport io from 'socket.io-client';\r\n\r\nconst socket = io('https://vvk954yznl.sse.codesandbox.io/');\r\n\r\nexport default class extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.localVideo = React.createRef();\r\n\t\tthis.remoteVideo = React.createRef();\r\n\r\n\t\tthis.pc = null;\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tsocket.on('x', (data) => this.receiveData(JSON.parse(data)));\r\n\r\n\t\tthis.start();\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tsocket.off('x');\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Fragment>\r\n\t\t\t\t<View style={{ flexDirection: 'row', justifyContent: 'center', alignItems: 'center', margin: 10 }}>\r\n\t\t\t\t\t<Button title={'Call'} onPress={this.call} />\r\n\t\t\t\t\t<View style={{ width: 10 }} />\r\n\t\t\t\t\t<Button title={'Hangup'} onPress={this.hangup} />\r\n\t\t\t\t</View>\r\n\r\n\t\t\t\t<View style={{ justifyContent: 'center', alignItems: 'center' }}>\r\n\t\t\t\t\t<video ref={this.localVideo} width='300' autoPlay muted />\r\n\r\n\t\t\t\t\t<video ref={this.remoteVideo} width='300' autoPlay />\r\n\t\t\t\t</View>\r\n\t\t\t</Fragment>\r\n\t\t);\r\n\t}\r\n\r\n\tstart = () => {\r\n\t\tconst configuration = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };\r\n\r\n\t\tthis.pc = new RTCPeerConnection(configuration);\r\n\r\n\t\tthis.pc.onicecandidate = (event) => {\r\n\t\t\tif (event.candidate) {\r\n\t\t\t\tthis.sendData({ candidate: event.candidate });\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.pc.onaddstream = (event) => {\r\n\t\t\tthis.remoteVideo.current.srcObject = event.stream;\r\n\t\t};\r\n\r\n\t\t//this.pc.oniceconnectionstatechange = (event) => console.log(this.pc.iceConnectionState);\r\n\r\n\t\tnavigator.mediaDevices.getUserMedia({ 'audio': true, 'video': true }).then((stream) => {\r\n\t\t\tthis.localVideo.current.srcObject = stream;\r\n\r\n\t\t\tthis.pc.addStream(stream);\r\n\t\t});\r\n\t};\r\n\r\n\tcall = async () => {\r\n\t\tconst offer = await this.pc.createOffer();\r\n\r\n\t\tawait this.pc.setLocalDescription(offer);\r\n\r\n\t\tthis.sendData({ sdp: this.pc.localDescription });\r\n\t};\r\n\r\n\thangup = async () => {\r\n\t\tthis.pc.close();\r\n\t\tthis.pc = null;\r\n\r\n\t\tthis.start();\r\n\t};\r\n\r\n\tsendData = async (data) => {\r\n\t\tsocket.emit('x', JSON.stringify(data));\r\n\t};\r\n\r\n\treceiveData = async (data) => {\r\n\t\tif (data.candidate !== undefined) {\r\n\t\t\tthis.pc.addIceCandidate(new RTCIceCandidate(data.candidate));\r\n\t\t}\r\n\t\telse if (data.sdp.type === 'offer') {\r\n\t\t\tthis.pc.setRemoteDescription(new RTCSessionDescription(data.sdp));\r\n\r\n\t\t\tconst answer = await this.pc.createAnswer();\r\n\r\n\t\t\tawait this.pc.setLocalDescription(answer);\r\n\r\n\t\t\tthis.sendData({ sdp: this.pc.localDescription });\r\n\t\t}\r\n\t\telse if (data.sdp.type === 'answer') {\r\n\t\t\tthis.pc.setRemoteDescription(new RTCSessionDescription(data.sdp));\r\n\t\t}\r\n\t};\r\n}\r\n","import React from 'react';\r\n\r\nimport WebRTCView from './WebRTCView'\r\n\r\nexport default () => {\r\n\treturn (\r\n\t\t<WebRTCView />\r\n\t);\r\n};\r\n","import { AppRegistry } from 'react-native';\r\n\r\nimport App from './App';\r\n\r\nAppRegistry.registerComponent('app', () => App);\r\nAppRegistry.runApplication('app', { rootTag: document.getElementById('root') });\r\n"],"sourceRoot":""}