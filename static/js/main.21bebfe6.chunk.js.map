{"version":3,"sources":["WebRTCView.js","App.js","index.js"],"names":["socket","io","_default","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","initialize","asyncToGenerator","regenerator_default","a","mark","_callee","mediaConstraints","configuration","stream","wrap","_context","prev","next","audio","video","iceServers","urls","navigator","mediaDevices","getUserMedia","sent","localVideo","current","srcObject","pc","RTCPeerConnection","addStream","onicecandidate","event","candidate","sendData","onaddstream","remoteVideo","oniceconnectionstatechange","console","log","iceConnectionState","stop","_callee2","offer","_context2","createOffer","setLocalDescription","hangup","_callee3","_context3","close","_ref4","_callee4","data","_context4","emit","JSON","stringify","_x","apply","arguments","receiveData","_ref5","_callee5","answer","_context5","undefined","type","addIceCandidate","setRemoteDescription","createAnswer","_x2","React","createRef","_this2","on","parse","off","react_default","createElement","react","View","style","flexDirection","Button","title","onPress","width","ref","autoPlay","muted","Component","App","WebRTCView_default","AppRegistry","registerComponent","runApplication","rootTag","document","getElementById"],"mappings":"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","file":"static/js/main.21bebfe6.chunk.js","sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { View, Button } from 'react-native';\nimport io from 'socket.io-client';\n\nconst socket = io('https://vvk954yznl.sse.codesandbox.io/');\n\nexport default class extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.localVideo = React.createRef();\n\t\tthis.remoteVideo = React.createRef();\n\n\t\tthis.pc = null;\n\t}\n\n\tcomponentDidMount() {\n\t\tsocket.on('webrtc', (data) => this.receiveData(JSON.parse(data)));\n\n\t\tthis.initialize();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tsocket.off('x');\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<View style={{ flexDirection: 'row' }}>\n\t\t\t\t\t<Button title={'Call'} onPress={this.call} />\n\t\t\t\t\t<View style={{ width: 10 }} />\n\t\t\t\t\t<Button title={'Hangup'} onPress={this.hangup} />\n\t\t\t\t</View>\n\n\t\t\t\t<View>\n\t\t\t\t\t<video ref={this.localVideo} width='300' autoPlay muted />\n\t\t\t\t\t<video ref={this.remoteVideo} width='300' autoPlay />\n\t\t\t\t</View>\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n\tinitialize = async () => {\n\t\tconst mediaConstraints = {\n\t\t\t'audio': true,\n\t\t\t'video': true\n\t\t};\n\n\t\tconst configuration = {\n\t\t\t'iceServers': [\n\t\t\t\t{ 'urls': 'stun:stun.l.google.com:19302' }\n\t\t\t]\n\t\t};\n\n\t\tconst stream = await navigator.mediaDevices.getUserMedia(mediaConstraints);\n\n\t\tthis.localVideo.current.srcObject = stream;\n\n\t\tthis.pc = new RTCPeerConnection(configuration);\n\n\t\tthis.pc.addStream(stream);\n\n\t\tthis.pc.onicecandidate = (event) => {\n\t\t\tif (event.candidate) {\n\t\t\t\tthis.sendData(event.candidate);\n\t\t\t}\n\t\t};\n\n\t\tthis.pc.onaddstream = (event) => {\n\t\t\tthis.remoteVideo.current.srcObject = event.stream;\n\t\t};\n\n\t\tthis.pc.oniceconnectionstatechange = (event) => {\n\t\t\tconsole.log(this.pc ? this.pc.iceConnectionState : '...');\n\t\t};\n\t};\n\n\tcall = async () => {\n\t\tconst offer = await this.pc.createOffer();\n\n\t\tawait this.pc.setLocalDescription(offer);\n\n\t\tthis.sendData(offer);\n\t};\n\n\thangup = async () => {\n\t\tthis.pc.close();\n\t\tthis.pc = null;\n\n\t\tthis.initialize();\n\t};\n\n\tsendData = async (data) => {\n\t\tsocket.emit('webrtc', JSON.stringify(data));\n\t};\n\n\treceiveData = async (data) => {\n\t\tconsole.log(data);\n\n\t\tif (data.type === undefined) {\n\t\t\tthis.pc.addIceCandidate(data);\n\t\t}\n\t\telse if (data.type === 'offer') {\n\t\t\tthis.pc.setRemoteDescription(data);\n\n\t\t\tconst answer = await this.pc.createAnswer();\n\n\t\t\tawait this.pc.setLocalDescription(answer);\n\n\t\t\tthis.sendData(answer);\n\t\t}\n\t\telse if (data.type === 'answer') {\n\t\t\tthis.pc.setRemoteDescription(data);\n\t\t}\n\t};\n}\n","import React from 'react';\n\nimport WebRTCView from './WebRTCView'\n\nexport default () => {\n\treturn (\n\t\t<WebRTCView />\n\t);\n};\n","import { AppRegistry } from 'react-native';\n\nimport App from './App';\n\nAppRegistry.registerComponent('app', () => App);\nAppRegistry.runApplication('app', { rootTag: document.getElementById('root') });\n"],"sourceRoot":""}