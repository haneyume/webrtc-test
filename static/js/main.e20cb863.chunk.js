(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{42:function(e,t,n){e.exports=n(77)},71:function(e,t){},77:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(34),i=n.n(r),o=n(2),s=n.n(o),u=n(4),l=n(35),p=n(36),d=n(40),f=n(37),m=n(41),h=n(79),v=n(80),g=n(81),w=n(38),b=n.n(w)()("https://vvk954yznl.sse.codesandbox.io/"),x=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).initialize=Object(u.a)(s.a.mark(function e(){var t,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.on("chatAudio-signaling",function(e){return n.receiveData(JSON.parse(e))}),t={audio:!0,video:!1},a={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},e.next=5,navigator.mediaDevices.getUserMedia(t);case 5:n.localStream=e.sent,n.localVideo.current.srcObject=n.localStream,n.pc=new RTCPeerConnection(a),n.pc.addStream(n.localStream),n.pc.onicecandidate=function(e){e.candidate&&n.sendData("",e.candidate)},n.pc.onaddstream=function(e){n.remoteVideo.current.srcObject=e.stream},n.pc.oniceconnectionstatechange=function(){if(console.log(n.pc?n.pc.iceConnectionState:"..."),n.pc){var e=n.pc.iceConnectionState;"connected"!==e&&"completed"!==e||n.setState({isCalling:!0})}};case 12:case"end":return e.stop()}},e)})),n.uninitialize=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.off("chatAudio-signaling");case 1:case"end":return e.stop()}},e)})),n.call=Object(u.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.pc.createOffer();case 2:return t=e.sent,e.next=5,n.pc.setLocalDescription(t);case 5:n.sendData("",t),n.setState({isCalling:!0});case 7:case"end":return e.stop()}},e)})),n.hangup=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.pc.close(),n.pc=null,n.setState({isCalling:!1}),n.initialize();case 4:case"end":return e.stop()}},e)})),n.sendData=function(){var e=Object(u.a)(s.a.mark(function e(t,n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:b.emit("chatAudio-signaling",{chatUserId:t,data:JSON.stringify(n)});case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.receiveData=function(){var e=Object(u.a)(s.a.mark(function e(t){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t.type){e.next=5;break}return e.next=3,n.pc.addIceCandidate(t);case 3:e.next=19;break;case 5:if("offer"!==t.type){e.next=16;break}return e.next=8,n.pc.setRemoteDescription(t);case 8:return e.next=10,n.pc.createAnswer();case 10:return a=e.sent,e.next=13,n.pc.setLocalDescription(a);case 13:n.sendData("",a),e.next=19;break;case 16:if("answer"!==t.type){e.next=19;break}return e.next=19,n.pc.setRemoteDescription(t);case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.state={isCalling:!1},n.localVideo=c.a.createRef(),n.remoteVideo=c.a.createRef(),n.localStream=null,n.pc=null,n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.initialize()}},{key:"componentWillUnmount",value:function(){this.uninitialize()}},{key:"render",value:function(){return c.a.createElement(h.a,null,c.a.createElement(v.a,null,!this.state.isCalling&&c.a.createElement(g.a,{color:"success",onClick:this.call},"Call"),this.state.isCalling&&c.a.createElement(g.a,{color:"danger",onClick:this.hangup},"Hangup")),c.a.createElement(v.a,null,c.a.createElement("video",{ref:this.localVideo,width:"300",autoPlay:!0,muted:!0}),c.a.createElement("video",{ref:this.remoteVideo,width:"300",autoPlay:!0})))}}]),t}(c.a.Component);n(76);i.a.render(c.a.createElement(function(){return c.a.createElement(x,null)},null),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.e20cb863.chunk.js.map